{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/sec-gitops/","result":{"data":{"mdx":{"id":"be6f1f6b-04f2-5d87-b1af-f7678bb94b5c","excerpt":"Security of GitOps Introduction to GitOps GitOps is code-based infrastructure and operational procedure that rely on Git as a source control system. It is anâ€¦","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Security of GitOps\",\n  \"date\": \"2022-02-22T22:12:03.284Z\",\n  \"description\": \"Security of GitOps\",\n  \"author\": \"Mateusz Pruchniak\",\n  \"thumbnail\": \"images/GitOps-1.0.jpg\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", null, \"Security of GitOps\"), mdx(\"h2\", {\n    \"id\": \"introduction-to-gitops\"\n  }, \"Introduction to GitOps\"), mdx(\"p\", null, \"GitOps is code-based infrastructure and operational procedure that rely on Git as a source control system. It is an evolution of Infrastructure as Code (IaC) and a DevOps best practice that leverages Git as the single source of truth, and control mechanism for creating, updating, and deleting IT system infrastructure. Implementing and using GitOps based strategy changes the way of securing the overall IT systems. Proper implementation of GitOps strategy increases the security and reliability itself but still leaves several attack vectors open. Traditional processes mostly rely on human operational knowledge, expertise and actions performed manually but in case of GitOps all changes are made as interactions with Git repository.\\nGitOps allows to separate deployments from development and use full advantage of the immutable declarative infrastructure. Every element of the environment can be deployed as often as needed with the same result, instances are redeployed instead of restoring from multiple unique configurations and versions. Immutability of infrastructure protects from making changes from outside of the main deployment process and makes it easier to detect and reverse environment changes based on the declarative state in the Git repository.\\nOne of the other key benefits of GitOps could be more than just how to make the deployment of the infrastructure and software faster, but could also improve MTTR - Mean Time To Remediate/Repair. MTTR is an essential failure metric that represents the average time it takes to repair and restore a component or system to function. GitOps is also helpful in the case of the disaster recovery plan, rollback, and reversing changes.\"), mdx(\"h2\", {\n    \"id\": \"securing-gitops-repository-and-process\"\n  }, \"Securing GitOps Repository and Process\"), mdx(\"p\", null, \"GitOps provides:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"a SINGLE source of truth for the state of a given environment,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"a SINGLE process to introduce changes,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"a SINGLE source of truth to run security scans against intended state, allowing for best practices to be enforced before they reach the target environments,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"a SINGLE source of truth to run security scans against previous states to identify when a security issue was introduced (i.e. git bisect),\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"a SINGLE set of tests, \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"a SINGLE set of permissions and implement necessary controls and gates on this process to make sure that you can meet security requirements. \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"ability to eliminate the need to make manual changes on environments.\\nThe centralized management process provides easy access to audit trail: what was changed, who and why made changes. It is achievable thanks to the full history of every change with a dedicated commit message. The best practice of GitOps requires enforcing master branch protection by making Pull Requests with required code review by other senior specialists.\")), mdx(\"h3\", {\n    \"id\": \"secure-git-repository\"\n  }, \"Secure Git Repository\"), mdx(\"p\", null, \"In general, the Git repository should be treated as a standard production system and secured in the same way, including the principle of least privilege as well as the separation of duties.\"), mdx(\"p\", null, \"Particular attention should be focus on:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Correct level of oversight and access control to repository,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Enforce branching policy and protect release and shared (i.e. main) branches, \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Enforce peer reviews before changes are merged in shared repositories (i.e. GitHub's Pull Request reviews, pair programming),\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Enforce policy to block sensitive data being pushed to Git, in order to store secrets and credentials safely in a public or private Git repository, use Mozilla SOPS CLI or SealedSecrets to protect it,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Enforce strong identity with GPG Signed Commits, to give accountability and traceability,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Require linear history and maintain a commit history by disallowing force pushes,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Require dedicated reviewers to accept Pull Requests and reviewers from Code Owners (a CODEOWNERS file),\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Enforce static code analysis to security checks,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Use dedicated technical accounts for GitOps (read-only access) and for CI/CD pipelines,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Monitoring of Git vulnerabilities, keeping Git and related tools up to date,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Rotate SSH keys and Personal Access Tokens, block unauthorized access to Git repositories, \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Monitor and implement alerting mechanism,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Use physical GPG Keys to increase security,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Always backup Git repositories, backup can be used by verification tools to verify integrity of repository that the commits hashes match, so that if somebody rewrites history to bypass the protections, then commit hashes will not match.\")), mdx(\"h3\", {\n    \"id\": \"securing-gitops-process\"\n  }, \"Securing GitOps Process\"), mdx(\"p\", null, \"GitOps Process should be secure by design. GitOps processes are responsible to deliver changes to the production environment and if that process is compromised then it can open backdoor in infrastructure or deliver harmful software to the production environment. GitOps processes need to utilize a dedicated non-user technical account for access where credentials are frequently rotated and short lived. It should be restricted who can make changes in process itself including the principle of least privilege as well as the separation of duties. It should be avoided to use administration permissions. GitOps process should be hardened and protected from elevating permissions to remove security features without leaving an audit trail and triggering alerts. List of allowed repositories should be limited by using FQDN filtering.\\nIt is important to implement quality gates in the process and prevent the deployment of containers with critical vulnerability (use e.g. Open Policy Agent, Grafeas, Kritis).\"), mdx(\"h3\", {\n    \"id\": \"securing-gitops-containers\"\n  }, \"Securing GitOps Containers\"), mdx(\"p\", null, \"GitOps require that only images that have successfully passed and gone through all the steps of CI/CD pipeline are allowed to be deployed into every environment.\\nProcess of building images should be hermetic and nobody can sideload images bypassing the main process. GitOps containers should be stored in a private container registry, not only for security reasons but also for reliability, performance, and privacy. Containers should be immutable and never change the meaning of a container as well as an assigned tag. Every container should be scanned for vulnerabilities (e.g. TwistLock), dependency scanning, signed and verified compliance with CIS Kubernetes Benchmark.\"));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"title":"Security of GitOps","date":"February 22, 2022","description":"Security of GitOps","author":"Mateusz Pruchniak","thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAACAAH/2gAMAwEAAhADEAAAAUuybBMJMv/EABkQAAMBAQEAAAAAAAAAAAAAAAABAhEDE//aAAgBAQABBQKFDHPLzekvCqoT1f/EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/Aaf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwGH/8QAGRAAAgMBAAAAAAAAAAAAAAAAABABETEh/9oACAEBAAY/Aia1cNX/xAAZEAEAAwEBAAAAAAAAAAAAAAABABEhMUH/2gAIAQEAAT8hQzc0WOuPNX2/SC0RCqYr3EBZ/9oADAMBAAIAAwAAABDHP//EABcRAQEBAQAAAAAAAAAAAAAAAAEAESH/2gAIAQMBAT8QS9ywb//EABcRAQEBAQAAAAAAAAAAAAAAAAEAESH/2gAIAQIBAT8QGc21L//EABwQAQADAQADAQAAAAAAAAAAAAEAESFxMUFRgf/aAAgBAQABPxAK1Nvrd9TNeswHAdPziw7pU6xMn2Go4XqbvmMTams//9k="},"images":{"fallback":{"src":"/static/53e1b9dc3cf23ceb0427d58d197fd743/bc365/GitOps-1.0.jpg","srcSet":"/static/53e1b9dc3cf23ceb0427d58d197fd743/293e0/GitOps-1.0.jpg 163w,\n/static/53e1b9dc3cf23ceb0427d58d197fd743/d47aa/GitOps-1.0.jpg 325w,\n/static/53e1b9dc3cf23ceb0427d58d197fd743/bc365/GitOps-1.0.jpg 650w","sizes":"(min-width: 650px) 650px, 100vw"},"sources":[{"srcSet":"/static/53e1b9dc3cf23ceb0427d58d197fd743/fb062/GitOps-1.0.avif 163w,\n/static/53e1b9dc3cf23ceb0427d58d197fd743/c5d98/GitOps-1.0.avif 325w,\n/static/53e1b9dc3cf23ceb0427d58d197fd743/e6341/GitOps-1.0.avif 650w","type":"image/avif","sizes":"(min-width: 650px) 650px, 100vw"},{"srcSet":"/static/53e1b9dc3cf23ceb0427d58d197fd743/34e66/GitOps-1.0.webp 163w,\n/static/53e1b9dc3cf23ceb0427d58d197fd743/22542/GitOps-1.0.webp 325w,\n/static/53e1b9dc3cf23ceb0427d58d197fd743/59444/GitOps-1.0.webp 650w","type":"image/webp","sizes":"(min-width: 650px) 650px, 100vw"}]},"width":650,"height":365}}}}},"previous":{"slug":"1.0-announcement/","frontmatter":{"title":"OpenGitOps 1.0 is finally here and why you should care"}},"next":{"slug":"gitops-days-2022/","frontmatter":{"title":"GitOps Days 2022"}}},"pageContext":{"id":"be6f1f6b-04f2-5d87-b1af-f7678bb94b5c","previousPostId":"aaeafb17-c368-5abe-933f-3a294115d7b0","nextPostId":"9f57318b-b488-5642-bd09-a5554b721d4e"}},"staticQueryHashes":["1696548092","2347561081","2841359383","3159585216","4031882365"]}